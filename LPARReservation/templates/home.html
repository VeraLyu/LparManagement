<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>LPAR RESERVATION</title>
    <link href="{{ STATIC_URL }}css/bootstrap.min.css" rel="stylesheet">
    <link href="{{ STATIC_URL }}css/bootcamp.css" rel="stylesheet">
    <script src="{{ STATIC_URL }}js/countdown.js"></script>
    <script type="text/javascript">
        window.onload = function (){countdown();}
    </script>
  </head>
  <body style="font-family: Microsoft Yahei, sans-serif">
    <header id="header-p-beta2">
      <div class="container-fluid">
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
          <a class="navbar-brand" href={% url 'home' %}>LPAR RESERVATION</a>
{% if not is_login %}
          <ul class="nav navbar-nav navbar-right">
            <li>
              <form action="/openid/login/" method="GET">
                <input type="hidden" name="openid_identifier" value="https://w3-03.sso.ibm.com/FIM/openidsso">
                <button type="submit" class="btn btn-primary" style="margin-right: 30px; margin-top:7px;margin-bottom:5px">Sign In</button>
              </form> 
            </li>
          </ul>
{% else %}
          <ul class="nav navbar-nav navbar-right">
            <li>
              <form action="/logout/" method="GET">
                <input type="hidden" name="openid_identifier" value="https://w3-03.sso.ibm.com/FIM/openidsso">
                <button type="submit" class="btn btn-primary"
                style="margin-right: 30px; margin-top:7px;margin-bottom:5px">Sign Out</button>
              </form> 
            </li>
          </ul>
{% endif %}
        </nav>
      </div>
    </header>
    <main>
      <div class="container">
        <table class="table table-striped" style="text-align:center; vertical-align:middle">
          <h3 align="center">LPAR RESERVATION</h3>
          <tr>
            <th style="text-align:center; vertical-align:middle">Name</th>
            <th style="text-align:center; vertical-align:middle">IP</th>
            <th style="text-align:center; vertical-align:middle">Available</th>
            <th style="text-align:center; vertical-align:middle">Reserved-by</th>
            <th style="text-align:center; vertical-align:middle">Time Left</th>
{% if is_login %}
            <th style="text-align:center; vertical-align:middle">Action</th>
{% endif %}
            </tr>
{% for lpar in lpars %}
          <tr>
            <td><i>{{ lpar.name }}</i></td>
            <td><i>{{ lpar.ip }}</i></td>
            <td><i>{%if lpar.available %}Yes{% else %}No{% endif %}</i></td>
            <td><i>{% if lpar.rsv_person %}{{ lpar.rsv_person}}{% else %} N/A {% endif %}</i></td>
            <td><i>{% if lpar.rsv_person %}<div id='{{ lpar.name }}'value='{{ lpar.reservation_time | date:"H:i:s" }}'></div>{% else %} N/A {% endif %}</i></td>
{% if is_login %}
            <td>
{% ifequal lpar.rsv_person user_name %}
              <form action="/cancel/" method="GET">
                <input type="hidden" name="lparid" value="{{ lpar.id }}">
                <button type="submit" class="btn btn-primary"
                style="margin-right: 30px; margin-top:7px;margin-bottom:5px"
                data-toggle="tooltip" data-placement="bottom" title="Release this LPAR">Cancel</button>
              </form> 
{% endifequal %}
{% if lpar.available %}
              <form action="/reserve/" method="GET">
                <input type="hidden" name="lparid" value="{{ lpar.id }}">
                <button type="submit" class="btn btn-primary"
                style="margin-right: 30px; margin-top:7px;margin-bottom:5px"
                data-toggle="tooltip" data-placement="bottom" title="LPAR will be released after 4 hours from this reservation">Reserve</button>
              </form> 
            </td>
{% endif %}
{% endif %}
          </tr>
{% endfor %}
        </table>
      </div>
    </main>
  </body>
  <footer>
  <div class="navbar navbar-fixed-bottom">
    <nav class="navbar navbar-default">
      <div class="navbar-inner navbar-content-center">
        <p class="text-muted credit" style="padding: 3px;">
          <center>CSTL KVM TEAM @IBM</center>
        </p>
      </div>
    </nav>
  </div>
  </footer>
</html>
